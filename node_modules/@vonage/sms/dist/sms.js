"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SMS = void 0;
const server_client_1 = require("@vonage/server-client");
const index_1 = require("./classes/index");
const index_2 = require("./enums/index");
class SMS extends server_client_1.Client {
    async send(params) {
        const resp = await this.sendPostRequest(`${this.config.restHost}/sms/json`, server_client_1.Client.transformers.kebabCaseObjectKeys(params));
        const messageData = server_client_1.Client.transformers.camelCaseObjectKeys(resp.data, true, true);
        const totalMessages = messageData.messageCount || 0;
        const messages = messageData.messages || [];
        const failures = messages.reduce((failures, { status }) => status !== index_2.SMSStatus.SUCCESS ? failures + 1 : failures, 0);
        if (failures < 1) {
            return messageData;
        }
        if (failures === totalMessages) {
            throw new index_1.MessageSendAllFailure(messageData);
        }
        throw new index_1.MessageSendPartialFailure(messageData);
    }
}
exports.SMS = SMS;
//# sourceMappingURL=sms.js.map